<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cardinality.Finite.SplitEnumerable.Instances</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="Cardinality.Finite.SplitEnumerable.Instances.html" class="Module">Cardinality.Finite.SplitEnumerable.Instances</a> <a id="87" class="Keyword">where</a>

<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Cardinality.Finite.SplitEnumerable.html" class="Module">Cardinality.Finite.SplitEnumerable</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Cardinality.Finite.SplitEnumerable.Inductive.html" class="Module">Cardinality.Finite.SplitEnumerable.Inductive</a>
<a id="198" class="Keyword">open</a> <a id="203" class="Keyword">import</a> <a id="210" href="Cardinality.Finite.ManifestBishop.html" class="Module">Cardinality.Finite.ManifestBishop</a> <a id="244" class="Keyword">using</a> <a id="250" class="Symbol">(</a><a id="251" href="Cardinality.Finite.ManifestBishop.html#2776" class="Function Operator">_|Π|_</a><a id="256" class="Symbol">)</a>
<a id="258" class="Keyword">open</a> <a id="263" class="Keyword">import</a> <a id="270" href="Data.Fin.html" class="Module">Data.Fin</a>
<a id="279" class="Keyword">open</a> <a id="284" class="Keyword">import</a> <a id="291" href="Prelude.html" class="Module">Prelude</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Data.List.Membership.html" class="Module">Data.List.Membership</a>
<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Data.Tuple.html" class="Module">Data.Tuple</a>

<a id="356" class="Keyword">import</a> <a id="363" href="Data.Unit.UniversePolymorphic.html" class="Module">Data.Unit.UniversePolymorphic</a> <a id="393" class="Symbol">as</a> <a id="396" class="Module">Poly</a>

<a id="402" class="Comment">-- So we can definitely do instance search for Π and Σ.</a>
<a id="458" class="Comment">--</a>
<a id="461" class="Comment">-- Problem:</a>
<a id="473" class="Comment">--</a>
<a id="476" class="Comment">-- * It interferes with instance search for → and ×.</a>
<a id="529" class="Comment">--</a>
<a id="532" class="Comment">-- module _ {a b} {A : Type a} (B : A → Type b) where</a>
<a id="586" class="Comment">--   Im-Type : (xs : List A) → Type (a ℓ⊔ b)</a>
<a id="631" class="Comment">--   Im-Type = foldr (λ x xs → ℰ! (B x) × xs) Poly.⊤</a>

<a id="685" class="Comment">--   Tup-Im-Lookup : ∀ x (xs : List A) → x ∈ xs → Im-Type xs → ℰ! (B x)</a>
<a id="757" class="Comment">--   Tup-Im-Lookup x (y ∷ xs) (f0   , y≡x ) (ℰ!⟨By⟩ , _) = subst (ℰ! ∘ B) y≡x ℰ!⟨By⟩</a>
<a id="842" class="Comment">--   Tup-Im-Lookup x (y ∷ xs) (fs n , x∈ys) (_ , ys) = Tup-Im-Lookup x xs (n , x∈ys) ys</a>

<a id="931" class="Comment">--   Tup-Im-Pi : (xs : ℰ! A) → Im-Type (xs .fst) → ∀ x → ℰ! (B x)</a>
<a id="997" class="Comment">--   Tup-Im-Pi xs tup x = Tup-Im-Lookup x (xs .fst) (xs .snd x) tup</a>

<a id="1066" class="Comment">-- instance</a>
<a id="1078" class="Comment">--   fin-sigma : ⦃ lhs : ℰ! A ⦄ {B : A → Type b} ⦃ rhs : Im-Type B (lhs .fst) ⦄ → ℰ! (Σ A B)</a>
<a id="1171" class="Comment">--   fin-sigma ⦃ lhs ⦄ ⦃ rhs ⦄ = lhs |Σ| Tup-Im-Pi _ lhs rhs</a>

<a id="1233" class="Comment">-- instance</a>
<a id="1245" class="Comment">--   fin-pi : ⦃ lhs : ℰ! A ⦄ {B : A → Type b} ⦃ rhs : Im-Type B (lhs .fst) ⦄ → ℰ! ((x : A) → B x)</a>
<a id="1343" class="Comment">--   fin-pi ⦃ lhs ⦄ ⦃ rhs ⦄ = lhs |Π| Tup-Im-Pi _ lhs rhs</a>

<a id="1402" class="Keyword">instance</a>
  <a id="fin-prod"></a><a id="1413" href="Cardinality.Finite.SplitEnumerable.Instances.html#1413" class="Function">fin-prod</a> <a id="1422" class="Symbol">:</a> <a id="1424" class="Symbol">⦃</a> <a id="1426" href="Cardinality.Finite.SplitEnumerable.Instances.html#1426" class="Bound">lhs</a> <a id="1430" class="Symbol">:</a> <a id="1432" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1435" href="Level.html#388" class="Generalizable">A</a> <a id="1437" class="Symbol">⦄</a> <a id="1439" class="Symbol">⦃</a> <a id="1441" href="Cardinality.Finite.SplitEnumerable.Instances.html#1441" class="Bound">rhs</a> <a id="1445" class="Symbol">:</a> <a id="1447" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1450" href="Level.html#401" class="Generalizable">B</a> <a id="1452" class="Symbol">⦄</a> <a id="1454" class="Symbol">→</a> <a id="1456" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1459" class="Symbol">(</a><a id="1460" href="Level.html#388" class="Generalizable">A</a> <a id="1462" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="1464" href="Level.html#401" class="Generalizable">B</a><a id="1465" class="Symbol">)</a>
  <a id="1469" href="Cardinality.Finite.SplitEnumerable.Instances.html#1413" class="Function">fin-prod</a> <a id="1478" class="Symbol">⦃</a> <a id="1480" href="Cardinality.Finite.SplitEnumerable.Instances.html#1480" class="Bound">lhs</a> <a id="1484" class="Symbol">⦄</a> <a id="1486" class="Symbol">⦃</a> <a id="1488" href="Cardinality.Finite.SplitEnumerable.Instances.html#1488" class="Bound">rhs</a> <a id="1492" class="Symbol">⦄</a> <a id="1494" class="Symbol">=</a> <a id="1496" href="Cardinality.Finite.SplitEnumerable.Instances.html#1480" class="Bound">lhs</a> <a id="1500" href="Cardinality.Finite.SplitEnumerable.html#3709" class="Function Operator">|×|</a> <a id="1504" href="Cardinality.Finite.SplitEnumerable.Instances.html#1488" class="Bound">rhs</a>

<a id="1509" class="Keyword">instance</a>
  <a id="fin-sum"></a><a id="1520" href="Cardinality.Finite.SplitEnumerable.Instances.html#1520" class="Function">fin-sum</a> <a id="1528" class="Symbol">:</a> <a id="1530" class="Symbol">⦃</a> <a id="1532" href="Cardinality.Finite.SplitEnumerable.Instances.html#1532" class="Bound">lhs</a> <a id="1536" class="Symbol">:</a> <a id="1538" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1541" href="Level.html#388" class="Generalizable">A</a> <a id="1543" class="Symbol">⦄</a> <a id="1545" class="Symbol">⦃</a> <a id="1547" href="Cardinality.Finite.SplitEnumerable.Instances.html#1547" class="Bound">rhs</a> <a id="1551" class="Symbol">:</a> <a id="1553" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1556" href="Level.html#401" class="Generalizable">B</a> <a id="1558" class="Symbol">⦄</a> <a id="1560" class="Symbol">→</a> <a id="1562" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1565" class="Symbol">(</a><a id="1566" href="Level.html#388" class="Generalizable">A</a> <a id="1568" href="Cubical.Data.Sum.Base.html#170" class="Datatype Operator">⊎</a> <a id="1570" href="Level.html#401" class="Generalizable">B</a><a id="1571" class="Symbol">)</a>
  <a id="1575" href="Cardinality.Finite.SplitEnumerable.Instances.html#1520" class="Function">fin-sum</a> <a id="1583" class="Symbol">⦃</a> <a id="1585" href="Cardinality.Finite.SplitEnumerable.Instances.html#1585" class="Bound">lhs</a> <a id="1589" class="Symbol">⦄</a> <a id="1591" class="Symbol">⦃</a> <a id="1593" href="Cardinality.Finite.SplitEnumerable.Instances.html#1593" class="Bound">rhs</a> <a id="1597" class="Symbol">⦄</a> <a id="1599" class="Symbol">=</a> <a id="1601" href="Cardinality.Finite.SplitEnumerable.Instances.html#1585" class="Bound">lhs</a> <a id="1605" href="Cardinality.Finite.SplitEnumerable.html#3773" class="Function Operator">|⊎|</a> <a id="1609" href="Cardinality.Finite.SplitEnumerable.Instances.html#1593" class="Bound">rhs</a>

<a id="1614" class="Keyword">instance</a>
  <a id="fin-fun"></a><a id="1625" href="Cardinality.Finite.SplitEnumerable.Instances.html#1625" class="Function">fin-fun</a> <a id="1633" class="Symbol">:</a> <a id="1635" class="Symbol">{</a><a id="1636" href="Cardinality.Finite.SplitEnumerable.Instances.html#1636" class="Bound">A</a> <a id="1638" href="Cardinality.Finite.SplitEnumerable.Instances.html#1638" class="Bound">B</a> <a id="1640" class="Symbol">:</a> <a id="1642" href="Level.html#242" class="Function">Type₀</a><a id="1647" class="Symbol">}</a> <a id="1649" class="Symbol">⦃</a> <a id="1651" href="Cardinality.Finite.SplitEnumerable.Instances.html#1651" class="Bound">lhs</a> <a id="1655" class="Symbol">:</a> <a id="1657" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1660" href="Cardinality.Finite.SplitEnumerable.Instances.html#1636" class="Bound">A</a> <a id="1662" class="Symbol">⦄</a> <a id="1664" class="Symbol">⦃</a> <a id="1666" href="Cardinality.Finite.SplitEnumerable.Instances.html#1666" class="Bound">rhs</a> <a id="1670" class="Symbol">:</a> <a id="1672" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1675" href="Cardinality.Finite.SplitEnumerable.Instances.html#1638" class="Bound">B</a> <a id="1677" class="Symbol">⦄</a> <a id="1679" class="Symbol">→</a> <a id="1681" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1684" class="Symbol">(</a><a id="1685" href="Cardinality.Finite.SplitEnumerable.Instances.html#1636" class="Bound">A</a> <a id="1687" class="Symbol">→</a> <a id="1689" href="Cardinality.Finite.SplitEnumerable.Instances.html#1638" class="Bound">B</a><a id="1690" class="Symbol">)</a>
  <a id="1694" href="Cardinality.Finite.SplitEnumerable.Instances.html#1625" class="Function">fin-fun</a> <a id="1702" class="Symbol">⦃</a> <a id="1704" href="Cardinality.Finite.SplitEnumerable.Instances.html#1704" class="Bound">lhs</a> <a id="1708" class="Symbol">⦄</a> <a id="1710" class="Symbol">⦃</a> <a id="1712" href="Cardinality.Finite.SplitEnumerable.Instances.html#1712" class="Bound">rhs</a> <a id="1716" class="Symbol">⦄</a> <a id="1718" class="Symbol">=</a> <a id="1720" href="Cardinality.Finite.SplitEnumerable.Instances.html#1704" class="Bound">lhs</a> <a id="1724" href="Cardinality.Finite.ManifestBishop.html#2776" class="Function Operator">|Π|</a> <a id="1728" class="Symbol">λ</a> <a id="1730" href="Cardinality.Finite.SplitEnumerable.Instances.html#1730" class="Bound">_</a> <a id="1732" class="Symbol">→</a> <a id="1734" href="Cardinality.Finite.SplitEnumerable.Instances.html#1712" class="Bound">rhs</a>

<a id="1739" class="Keyword">instance</a>
  <a id="fin-bool"></a><a id="1750" href="Cardinality.Finite.SplitEnumerable.Instances.html#1750" class="Function">fin-bool</a> <a id="1759" class="Symbol">:</a> <a id="1761" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1764" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="1771" href="Cardinality.Finite.SplitEnumerable.Instances.html#1750" class="Function">fin-bool</a> <a id="1780" class="Symbol">=</a> <a id="1782" href="Cardinality.Finite.SplitEnumerable.html#2593" class="Function">ℰ!⟨2⟩</a>

<a id="1789" class="Keyword">instance</a>
  <a id="fin-top"></a><a id="1800" href="Cardinality.Finite.SplitEnumerable.Instances.html#1800" class="Function">fin-top</a> <a id="1808" class="Symbol">:</a> <a id="1810" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1813" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="1817" href="Cardinality.Finite.SplitEnumerable.Instances.html#1800" class="Function">fin-top</a> <a id="1825" class="Symbol">=</a> <a id="1827" href="Cardinality.Finite.SplitEnumerable.html#2758" class="Function">ℰ!⟨⊤⟩</a>

<a id="1834" class="Keyword">instance</a>
  <a id="fin-bot"></a><a id="1845" href="Cardinality.Finite.SplitEnumerable.Instances.html#1845" class="Function">fin-bot</a> <a id="1853" class="Symbol">:</a> <a id="1855" href="Cardinality.Finite.SplitEnumerable.Inductive.html#177" class="Function">ℰ!</a> <a id="1858" href="Cubical.Data.Empty.Base.html#114" class="Datatype">⊥</a>
  <a id="1862" href="Cardinality.Finite.SplitEnumerable.Instances.html#1845" class="Function">fin-bot</a> <a id="1870" class="Symbol">=</a> <a id="1872" href="Cardinality.Finite.SplitEnumerable.html#2819" class="Function">ℰ!⟨⊥⟩</a>
</pre></body></html>