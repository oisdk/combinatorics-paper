\PassOptionsToPackage{dvipsnames}{xcolor}
\documentclass[acmsmall,review,anonymous]{acmart}
\settopmatter{printfolios=true}

\acmJournal{PACMPL}
\acmVolume{1}
\acmNumber{POPL}
\acmArticle{1}
\acmYear{2018}
\acmMonth{1}
\acmDOI{} % \acmDOI{10.1145/nnnnnnn.nnnnnnn}
\startPage{1}

\bibliographystyle{ACM-Reference-Format}
\citestyle{acmauthoryear}


% The thesis is organised by chapter, whereas the paper by section.
% This lets us change between the two without any changes to the tex files.
\let\chapter\section%
\let\section\subsection%
\let\subsection\subsubsection%
\let\subsubsection\paragraph%

\usepackage{multicol}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{url}
\usepackage{catchfilebetweentags}
\usepackage{setspace}

\let\Bbbk\relax
\input{agda}
\AgdaNoSpaceAroundCode{}

\usepackage{tikz-cd}
\tikzcdset{%
  arrow style=tikz,
  diagrams={>={Straight Barb[scale=0.8]}},
}
\usepackage{amsmath}
\usepackage{amsthm}
\renewcommand{\qed}{\ensuremath{\hfill\blacksquare}}
\makeatletter
\newcommand{\eqnum}{\leavevmode\textup{\tagform@{\theequation}}}
\makeatother

\usepackage{dashbox}
\setlength{\dashlength}{2pt}
\setlength{\dashdash}{.75pt}
\usepackage{varwidth}
\usepackage{environ}
\NewEnviron{agdalisting}[1][\dbox]{\vspace{\abovedisplayskip}%

  \refstepcounter{equation}%
  \hfill%
  {\begin{varwidth}{\linewidth}% Add #1 just before { on this line to make agda
                               % code boxed with dots
        \BODY%
      \end{varwidth}%
      \vspace{\belowdisplayskip}%
  }%
  \hfill%
  \eqnum%
  \break%
}
\NewEnviron{agdalisting*}[1][\dbox]{\vspace{\abovedisplayskip}%

  \hfill%
  {\begin{varwidth}{\linewidth}% Add #1 just before { on this line to make agda
      % code boxed with dots
      \BODY%
    \end{varwidth}%
    \vspace{\belowdisplayskip}%
  }%
  \hfill%
  \break%
}

\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}


% Haskell bind operator >>=
\newcommand\hbind{%
  \ensuremath{\gg\mkern-5.5mu=}%
}
% Haskell apply operator <*>
\newcommand\hap{%
  \ensuremath{\mathbin{<\mkern-9mu*\mkern-9mu>}}%
}
% Haskell alternative operator <|>
\newcommand\halt{%
  \ensuremath{\mathbin{<\mkern-5mu\vert\mkern-5mu>}}%
}
% Haskell fmap operator <$>$
\newcommand\hfmap{%
  \ensuremath{\mathbin{<\mkern-6mu\$\mkern-6mu>}}%
}
% Haskell mappend operator <>
\newcommand\hcmb{%
  \ensuremath{\mathbin{\diamond}}%
}
% Haskell fish operator <><
\newcommand\hcmbin{%
  \ensuremath{\mathbin{\diamond\mkern-7.4mu\rtimes}}%
}
% Haskell Kleisli composition <=<
\newcommand\hkcomp{%
  \ensuremath{\mathbin{<\mkern-10mu=\mkern-7mu<}}
}
% Haskell forall
\newcommand\hforall{%
  \ensuremath{\forall}%
}
% Unique membership \in!
\newcommand\inunique{%
  \mathrel{\in\mkern-6mu\raisebox{-0.5pt}{!}}
}
% Decide membership \in?
\newcommand\decin{%
  \mathrel{\in\mkern-6mu\raisebox{-0.5pt}{?}}
}
% Dot as wildcard character
\newcommand\wc{{\mkern2mu\cdot\mkern2mu}}
% Binary operator !
\newcommand\ind{\mathbin{!}}
\usepackage{subcaption}
\usepackage{multicol}
\usepackage{tabularx}
\usepackage{pict2e}
\usepackage{forest}
\usepackage{wrapfig}

\usepackage{todonotes}

% Proper double left paren [( (also ``plano-concave lens'')
\newcommand{\lbparen}{%
  \mathopen{%
    \sbox0{$()$}%
    \setlength{\unitlength}{\dimexpr\ht0+\dp0}%
    \raisebox{-\dp0}{%
      \begin{picture}(.32,1)
        \linethickness{\fontdimen8\textfont3}
        \roundcap
        \put(0,0){\raisebox{\depth}{$($}}
        \polyline(0.32,0)(0,0)(0,1)(0.32,1)
      \end{picture}%
    }%
  }%
}

% Proper double right paren [( (also ``plano-concave lens'')
\newcommand{\rbparen}{%
  \mathclose{%
    \sbox0{$()$}%
    \setlength{\unitlength}{\dimexpr\ht0+\dp0}%
    \raisebox{-\dp0}{%
      \begin{picture}(.32,1)
        \linethickness{\fontdimen8\textfont3}
        \roundcap
        \put(-0.08,0){\raisebox{\depth}{$)$}}
        \polyline(0,0)(0.32,0)(0.32,1)(0,1)
      \end{picture}%
    }%
  }%
}

\usepackage{cancel}

\PrerenderUnicode{Ã­}

% \usepackage{hyperref}

% Nice typesetting for the definition of an inductive type.
% For the following Agda-like thing:
%
% data List a where
%   []   : List a
%   (::) : a -> List a -> List a    
%
% write:
% \begin{inductivetype}{\mathbf{List}(A)}
%   \inductivetypeclause{\left[ \right]}{\mathbf{List}(A)}
%   \inductivetypeclause{\wc \dblcolon \wc}{A \rightarrow \mathbf{List}(A) \rightarrow \mathbf{List}(A)}
% \end{inductivetype}

\newif\iffirstclauseofinductivetype%
\newenvironment{inductivetype}[1]{%
  \firstclauseofinductivetypetrue%
  \begin{equation}
    \begin{alignedat}{3}
      #1
    }{%
    \end{alignedat}
  \end{equation}%
}
\newcommand{\inductivetypeclause}[2]{%
  \iffirstclauseofinductivetype%
    \coloneqq%
  \else%
    \\ \vert%
  \fi
  & \; #1 &:&& \; #2;
  \firstclauseofinductivetypefalse%
}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "paper"
%%% End:
